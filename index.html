<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tactical Battle Board</title>
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
        }
      }
    </script>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="panel header">
        <div class="header-left">
          <div class="current-map-label">Current map: <span id="current-map-label">None</span></div>
          <div class="cam-buttons header-cams">
            <button data-cam-slot="1">View 1</button>
            <button data-cam-slot="2">View 2</button>
            <button data-cam-slot="3">View 3</button>
            <button data-cam-slot="4">View 4</button>
            <button data-cam-slot="5">View 5</button>
            <button data-cam-slot="6">View 6</button>
            <button id="clear-cam-views">Clear Views</button>
          </div>
        </div>
        <div class="header-right">
          <div class="actions header-actions">
            <button id="log-open">Open Log</button>
            <button id="db-open">Open DB</button>
            <button id="tokens-open">Open Tokens</button>
            <button id="scripts-open">Scripts</button>
            <button id="params-open">View Parameters</button>
            <button id="lang-open">Battle Language</button>
          </div>
        </div>
      </header>


      <section class="panel map-panel">
        <canvas id="map-canvas"></canvas>
      </section>

    </main>

    <div id="log-window" class="log-window">
      <div class="log-window-header">
        <span>Log</span>
        <div class="log-actions">
          <button id="log-clear">Clear</button>
          <button id="log-copy">Copy</button>
        </div>
        <button id="log-close">Close</button>
      </div>
      <div id="log" class="log-body"></div>
    </div>

    <div id="db-window" class="db-window">
      <div class="db-window-header">
        <span>Local Storage</span>
        <button id="db-close">Close</button>
      </div>
      <div id="db-body" class="db-body"></div>
    </div>

    <div id="tokens-window" class="tokens-window">
      <div class="tokens-window-header">
        <span>Active Tokens</span>
        <button id="tokens-close">Close</button>
      </div>
      <div id="tokens-body" class="tokens-body"></div>
      <div class="tokens-window-resize" aria-label="Resize tokens window"></div>
    </div>

    <div id="scripts-window" class="scripts-window">
      <div class="scripts-window-header">
        <span>Scripts</span>
        <button id="scripts-close">Close</button>
      </div>
      <div class="scripts-window-body">
        <label class="test-toggle"><input type="checkbox" id="show-test-dirs" /> Test Dirs</label>
        <div id="script-tree-scroll" class="tree-scroll">
          <div id="script-tree" class="script-tree" aria-label="Script list"></div>
        </div>
      </div>
      <div class="scripts-window-resize" aria-label="Resize scripts window"></div>
    </div>

    <div id="lang-window" class="lang-window">
      <div class="lang-window-header">
        <span>Battle Language</span>
        <button id="lang-close">Close</button>
      </div>
      <div class="lang-body">
        <div class="actions">
          <button id="run-btn">Run Script</button>
          <button id="run-selected-btn">Run Selected</button>
          <button id="clear-btn">Clear Tokens</button>
        </div>
        <textarea id="script-input" class="console" spellcheck="false"></textarea>
      </div>
      <div class="lang-window-resize" aria-label="Resize battle language window"></div>
    </div>

    <div id="params-window" class="params-window">
      <div class="params-window-header">
        <span>View Parameters</span>
        <button id="params-close">Close</button>
      </div>
      <div class="params-body">
        <div class="field slider-field">
          <label for="move-speed-scale">Move speed</label>
          <input id="move-speed-scale" type="range" min="0.1" max="2" step="0.05" value="1" />
          <span class="slider-value" id="move-speed-scale-value">1.00x</span>
        </div>
        <div class="field slider-field">
          <label for="heat-height">Height map scale</label>
          <input id="heat-height" type="range" min="1" max="6" step="0.2" value="3" />
          <span class="slider-value" id="heat-height-value">3.0x</span>
        </div>
        <div class="field">
          <label><input type="checkbox" id="arena-grid" /> Show XYZ arena grid</label>
        </div>
        <div class="field">
          <label><input type="checkbox" id="show-texture" checked /> Show texture map</label>
        </div>
        <div class="field">
          <label><input type="checkbox" id="show-height" checked /> Show height map</label>
        </div>
        <div class="field">
          <label><input type="checkbox" id="show-overlay-grid" checked /> Show overlay grid/hex</label>
        </div>
        <div class="field">
          <label><input type="checkbox" id="show-overlay-labels" checked /> Show grid refs (A0...)</label>
        </div>
        <div class="field">
          <label><input type="checkbox" id="show-models" checked /> Show 3D models on tokens</label>
        </div>
      </div>
      <div class="params-window-resize" aria-label="Resize"></div>
    </div>

    <script type="module" src="app.js"></script>
  </body>
</html>
